<html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="UTF-8"><style type="text/css"></style>

   
    
     
      

    

     
 <meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" media="handheld" href="7724077.htm#">

    <title>右键菜单事件contextMenuEvent(QContextMenuEvent *event) - 夜影轩的专栏
        - 博客频道 - CSDN.NET</title>
    
    <meta name="description" content="最近项目中需要用到ListView下拉刷新的功能，一开始想图省事，在网上直接找一个现成的，可是尝试了网上多个版本的下拉刷新之后发现效果都不怎么理想。有些是因为功能不完整或有Bug，有些是因为使用起来太复杂，十全十美的还真没找到。因此我也是放弃了在网上找现成代码的想法，自己花功夫实现了一套非常简单的下拉刷新方案，现在拿出来和大家分享一下。相信在阅读完本篇文章之后，大家都可以在自己的项目中一分钟引入下拉刷新功能。首先讲一下实现原理">
    
    
        <!--new top-->
       
        <link rel="stylesheet" href="index.css">
        <!--new top-->

    <link rel="Stylesheet" type="text/css" href="style.css_v_1.1.css">
    <link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="http://blog.csdn.net/yuanzhangmei1/rss/list">
    <link rel="shortcut icon" href="http://c.csdnimg.cn/public/favicon.ico">
    <link type="text/css" rel="stylesheet" href="blue_green.css">
 



<link rel="stylesheet" type="text/css" href="job_reco.css"><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 25px; height: 18px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><link rel="stylesheet" type="text/css" href="job_reco.css"><link rel="stylesheet" type="text/css" href="style.css_4d63d.css"></head><body><div id="MathJax_Message" style="display: none; "></div>
    
   
      <!--new top-->
    <div class="csdn-toolbar csdn-toolbar-skin-black ">        <div class="container row center-block ">          <div class="col-md-3 pull-left logo clearfix"><a href="http://www.csdn.net/?ref=toolbar" title="CSDN首页" target="_blank" class="icon"></a><a title="频道首页" href="http://blog.csdn.net/?ref=toolbar_logo" class="img blog-icon"></a></div>          <div class="pull-right login-wrap ">            <ul class="btns">              <li class="loginlink"><a href="https://passport.csdn.net/account/login?ref=toolbar" target="_top">登录&nbsp;</a>|<a target="_top" href="http://passport.csdn.net/account/mobileregister?action=mobileRegister">&nbsp;注册</a></li>              <li class="search">                <div class="icon on-search-icon">                  <div class="wrap">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <form action="http://so.csdn.net/search" method="get" target="_blank">                      <input type="hidden" value="toolbar" name="ref" accesskey="2">                      <div class="border">                        <input placeholder="搜索" type="text" value="" name="q" accesskey="2"><span class="icon-enter-sm"></span>                      </div>                    </form>                  </div>                </div>              </li>              <li class="favor">                <div class="icon on-favor-icon">                  <div class="wrap">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <div style="display:none;" class="favor-success"><span class="msg">收藏成功</span>                      <div class="btns"><span class="btn btn-primary ok">确定</span></div>                    </div>                    <div style="display:none;" class="favor-failed"><span class="icon-danger-lg"></span><span class="msg">收藏失败，请重新收藏</span>                      <div class="btns"><span class="btn btn-primary ok">确定</span></div>                    </div>                    <form role="form" class="form-horizontal favor-form">                      <div class="form-group">                        <div class="clearfix">                          <label for="input-title" class="col-sm-2 control-label">标题</label>                          <div class="col-sm-10">                            <input id="inputTitle" type="text" placeholder="" class="title form-control">                          </div>                        </div>                        <div class="alert alert-danger"><strong></strong>标题不能为空</div>                      </div>                      <div class="form-group">                        <label for="input-url" class="col-sm-2 control-label">网址</label>                        <div class="col-sm-10">                          <input id="input-url" type="text" placeholder="" class="url form-control">                        </div>                      </div>                      <div class="form-group">                        <label for="input-tag" class="col-sm-2 tag control-label">标签</label>                        <div class="col-sm-10">                          <input id="input-tag" type="text" class="form-control tag">                        </div>                      </div>                      <div class="form-group">                        <label for="input-description" class="description col-sm-2 control-label">摘要</label>                        <div class="col-sm-10">                          <textarea id="input-description" class="form-control description"></textarea>                        </div>                      </div>                      <div class="form-group">                        <div class="col-sm-offset-2 col-sm-10 ft">                          <div class="col-sm-4 pull-left">                            <div class="checkbox">                              <label>                                <input type="checkbox" name="share" checked="checked" class="share">公开                              </label>                            </div>                          </div>                          <div class="col-sm-8 pull-right favor-btns">                            <button type="button" class="cancel btn btn-default">取消</button>                            <button type="submit" class="submit btn btn-primary">收藏</button>                          </div>                        </div>                      </div>                    </form>                  </div>                </div>              </li>              <li class="notify">                <div style="display:none" class="number"></div>                <div style="display:none" class="icon-hasnotes-sm"></div>                <div id="header_notice_num"></div>                <div class="icon on-notify-icon">                  <div class="wrap">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <div id="note1" class="csdn_note">                      <div class="box"><div class="notifications notice_list_con curr">  <div class="menu_title">    <span class="title"><a href="http://msg.csdn.net/letters" target="_blank" class="read_all">查看所有私信</a><a href="http://msg.csdn.net/" target="_blank" class="go_all">查看所有通知</a></span>  </div>  <div class="loading"></div>  <div class="empty">暂没有新通知</div>  <div class="notice_content"></div></div><div class="notifications detail_con" style="display: none">  <div class="menu_title">    <span class="title">      <a class="go_back" href="javascript:void 0;">返回通知列表</a>      <a class="notifications_page_none nextnote" href="javascript:void 0;">下一条</a>      <a class="notifications_page prvnote" href="javascript:void 0;">上一条</a>    </span>  </div>  <div class="notice_content" style="overflow-y: scroll; height: 250px;"></div></div><div class="error"></div></div>                    <iframe src="about:block" frameborder="0" allowtransparency="true" style="z-index:-1;position:absolute;top:0;left:0;width:100%;height:100%;background:transparent" src="0.htm"></iframe></div>                  </div>                </div>              </li>              <li class="ugc">                <div class="icon on-ugc-icon">                  <div class="wrap clearfix">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <dl>                      <dt><a href="http://geek.csdn.net/news/expert?ref=toolbar" target="_blank" class="p-news clearfix" style="display:none;"><em class="icon"></em><span>分享资讯</span></a></dt>                      <dt><a href="http://u.download.csdn.net/upload?ref=toolbar" target="_blank" class="p-doc clearfix"><em class="icon"></em><span>传PPT/文档</span></a></dt>                      <dt><a href="http://bbs.csdn.net/topics/new?ref=toolbar" target="_blank" class="p-ask clearfix"><em class="icon"></em><span>提问题</span></a></dt>                      <dt><a href="http://write.blog.csdn.net/postedit?ref=toolbar" target="_blank" class="p-blog clearfix"><em class="icon"></em><span>写博客</span></a></dt>                      <dt><a href="http://u.download.csdn.net/upload?ref=toolbar" target="_blank" class="p-src clearfix"><em class="icon"></em><span>传资源</span></a></dt>                      <dt><a href="https://code.csdn.net/projects/new?ref=toolbar" target="_blank" class="c-obj clearfix"><em class="icon"></em><span>创建项目</span></a></dt>                      <dt><a href="https://code.csdn.net/snippets/new?ref=toolbar" target="_blank" class="c-code clearfix"><em class="icon"></em><span>创建代码片</span></a></dt>                    </dl>                  </div>                </div>              </li>              <li class="profile">                <div class="icon on-profile-icon"><img src="2_bienilz.jpg.gif" class="curr-icon-img">                  <div class="wrap clearfix">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <div class="bd">                      <dl class="clearfix">                        <dt class="pull-left img"><a target="_blank" href="http://my.csdn.net/?ref=toolbar" class="avatar"><img src="2_bienilz.jpg.gif"></a></dt>                        <dd class="info" style="border: none;"><a target="_blank" href="http://my.csdn.net/?ref=toolbar" class="nickname">bienilz</a><span class="dec"><a class="fill-dec" href="http://my.csdn.net/" target="_blank">编辑自我介绍，让更多人了解你<span class="write-icon"></span></a></span></dd>                      </dl>                    </div>                    <div class="ft clearfix"><a target="_blank" href="http://my.csdn.net/my/account/changepwd?ref=toolbar" class="pull-left"><span class="icon-cog"></span>帐号设置</a><a href="https://passport.csdn.net/account/logout?ref=toolbar" target="_top" class="pull-left" style="margin-left:132px; width:18px; height:27px; white-space:nowrap; overflow:hidden;"><span class="icon-signout"></span><span class="out">退出</span></a></div>                  </div>                </div>              </li>              <li class="apps">                <div id="chasnew123" class="hasnew" style="display: none; "></div>                <div id="cappsarea123" class="icon on-apps-icon">                  <div class="wrap clearfix">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                  <div class="detail">                    <dl>                      <dt>                        <h5>社区</h5>                      </dt>                      <dd> <a href="http://blog.csdn.net/?ref=toolbar" target="_blank">博客</a></dd>                      <dd> <a href="http://bbs.csdn.net/?ref=toolbar" target="_blank">论坛</a></dd>                      <dd> <a href="http://download.csdn.net/?ref=toolbar" target="_blank">下载</a></dd>                      <dd><a href="http://ask.csdn.net/?ref=toolbar" target="_blank">技术问答</a></dd>                      <dd><a href="http://geek.csdn.net/?ref=toolbar" target="_blank">极客头条</a></dd>                      <dd> <a href="http://hero.csdn.net/?ref=toolbar" target="_blank">英雄会</a></dd>                    </dl>                  </div>                  <div class="detail">                    <dl>                      <dt>                        <h5>服务</h5>                      </dt>                      <dd> <a href="http://job.csdn.net/?ref=toolbar" target="_blank">JOB<img src="new.gif" style="display: none; margin-top: -26px; width: 23px;"></a></dd>                      <dd> <a href="http://edu.csdn.net/?ref=toolbar" target="_blank">学院<img src="new.gif" style="display: none; margin-top: -26px; width: 23px;"></a></dd>                      <dd> <a href="https://code.csdn.net/?ref=toolbar" target="_blank">CODE</a></dd>                      <dd> <a href="http://huiyi.csdn.net/?ref=toolbar" target="_blank">活动</a></dd>                      <dd> <a href="http://www.csto.com/?ref=toolbar" target="_blank">CSTO</a></dd>                      <dd> <a href="http://mall.csdn.net/?ref=toolbar" target="_blank">C币兑换<img src="new.gif" style="display: none; margin-top: -26px; width: 23px;"></a></dd>                    </dl>                  </div>                  <div class="detail last">                    <dl>                      <dt>                        <h5>俱乐部</h5>                      </dt>                      <dd> <a href="http://cto.csdn.net/?ref=toolbar" target="_blank">CTO俱乐部</a></dd>                      <dd> <a href="http://student.csdn.net/?ref=toolbar" target="_blank">高校俱乐部</a></dd>                    </dl>                  </div>                </div>              </div>            </li>            </ul>          </div>        </div>    </div>
     <!--new top-->
    <div id="container">
        <div id="header">
    <div class="header">
        <div id="blog_title">
            <h2>
                <a href="http://blog.csdn.net/yuanzhangmei1">夜影轩的专栏</a></h2>
            <h3>和奋斗的人一起奋斗，让蜗居的人蜗居去吧.....</h3>
            <div class="clear">
            </div>
        </div>
        <div class="clear">
        </div>
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg">
    </div>
    <div class="navigator">
        <ul>
            
                <li id="btnContents"><a href="http://blog.csdn.net/yuanzhangmei1?viewmode=contents"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_mulu'])">
                    <img src="ico_list.gif">目录视图</span></a></li>
                <li id="btnView"><a href="http://blog.csdn.net/yuanzhangmei1?viewmode=list"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_zhaiyao'])">
                    <img src="ico_summary.gif">摘要视图</span></a></li>
                <li id="btnRss"><a href="http://blog.csdn.net/yuanzhangmei1/rss/list"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_RSS'])">
                    <img src="ico_rss.gif">订阅</span></a></li>                

            </ul>
    </div>
</div>


        <div id="body">
            <div id="main">
                <div class="main">
                        <div class="ad_class">
<div class="notice tracking-ad" data-mod="popu_3"> 

<a href="http://special.csdncms.csdn.net/rust/index.shtml"><font color="red">
Rust开发技术学习路线</font></a>
&nbsp;&nbsp;&nbsp;
  

<a href="http://huiyi.csdn.net/activity/product/goods_list?project_id=2215">
<font color="blue">Android开发，8月14开课啦！
</font></a>
&nbsp;&nbsp;&nbsp;

<a href="http://bss.csdn.net/m/product/blog_essay">
<font color="red">聊聊高效编程，送800元大奖
</font></a>
&nbsp;&nbsp;&nbsp;
<a href="http://www.csdn.net/app/">
<font color="blue">CSDN移动客户端，下载送50C币
</font></a>
&nbsp;&nbsp;&nbsp;</div>                        </div>
                        

  
<link href="comment1.css" type="text/css" rel="stylesheet">
<link href="style1.css" type="text/css" rel="stylesheet">


<link rel="stylesheet" href="markdown_views.css_v_1.0.css">


  
<div id="article_details" class="details">
    <div class="article_title">   
         <span class="ico ico_type_Original"></span>


    <h1>
        <span class="link_title"><a href="7724077.htm">
        右键菜单事件contextMenuEvent(QContextMenuEvent *event)            
        </a>
        </span>
    </h1>
</div>

   

    <div class="article_manage">
        <span class="link_categories">
        分类：
            <a href="http://blog.csdn.net/yuanzhangmei1/article/category/1174123" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_fenlei']);">Qt</a> 
        </span>
    <span class="link_postdate">2012-07-07 10:22</span>
    <span class="link_view" title="阅读次数">3046人阅读</span>
    <span class="link_comments" title="评论次数"><a href="7724077.htm#comments" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_pinglun'])">评论</a>(0)</span>
    <span class="link_collect"><a href="javascript:void(0);" onclick="javascript:collectArticle('右键菜单事件contextMenuEvent(QContextMenuEvent *event)','7724077');return false;" title="收藏">收藏</a></span>
    <span class="link_report"><a href="7724077.htm#report" onclick="javascript:report(7724077,2);return false;" title="举报">举报</a></span>
    
</div>
<div class="tag2box"><a href="http://www.csdn.net/tag/signal" target="_blank" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">signal</a><a href="http://www.csdn.net/tag/qt" target="_blank" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">qt</a><a href="http://www.csdn.net/tag/menu" target="_blank" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">menu</a><a href="http://www.csdn.net/tag/filter" target="_blank" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">filter</a><a href="http://www.csdn.net/tag/action" target="_blank" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">action</a><a href="http://www.csdn.net/tag/table" target="_blank" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">table</a></div>

  

  
  
     

<div id="article_content" class="article_content">

<p><span>最近在看C++ GUI&nbsp; Qt4部分其中有个例子对于扩展一个应用程序提供一个上下文菜单，其中该程序只是定义一个变量来实现其中用到了一个函数（下文会给予解答）。但是更高级的是重新定义事件处理函数void contextMenuEvent(QContextMenuEvent *event)。下面讲解其contextMenuEvent(QContextMenuEvent *event)。</span></p>
<p><span></span><span>&nbsp;</span></p>
<p><span>QWidget及其子类都可有右键菜单，因为QWidget有以下两个与右键菜单有关的函数：</span></p>
<p><span>Qt::ContextMenuPolicy contextMenuPolicy () const</span></p>
<p><span>void setContextMenuPolicy ( Qt::ContextMenuPolicy policy )</span></p>
<p><span>Qt::ContextMenuPolicy枚举类型包括：Qt::DefaultContextMenu, Qt::NoContextMenu, Qt::PreventContextMenu, Qt::ActionsContextMenu, and Qt::CustomContextMenu。<br>
</span></p>
<p><span>使用方式如下：</span></p>
<p><span><strong>1）默认是Qt::DefaultContextMenu。<br>
</strong>它是利用右键菜单事件contextMenuEvent()来处理（which means the contextMenuEvent() handler is called)。就是要重写contextMenuEvent( QContextMenuEvent * event )函数。</span></p>
<p><span>例子(该例子即是我改写的)</span></p>
<pre class="cpp" name="code"><span>void MainWindow::contextMenuEvent(QContextMenuEvent *event)
{

    Context = new QMenu();
    Context-&gt;addAction(ui-&gt;actionCut);
    Context-&gt;addAction(ui-&gt;actionCope);
    Context-&gt;addAction(ui-&gt;actionPase);
    spreadsheet-&gt;setContextMenuPolicy(Qt::DefaultContextMenu);
    Context-&gt;exec(QCursor::pos());
}</span></pre>
<p><span><strong>2）使用Qt::CustomContextMenu。<br>
</strong>它是发出QWidget::customContextMenuRequested信号，注意仅仅只是发信号，意味着要自己写显示右键菜单的slot。这个信号是QWidget唯一与右键菜单有关的信号（也是自有的唯一信号），同时也是很容易被忽略的signal：</span></p>
<p><span>void customContextMenuRequested ( const QPoint &amp; pos )</span></p>
<p><span>该信号的发出条件是：用户请求contextMenu（常规就是鼠标右击啦）且同时被击的widget其contextMenuPolicy又是Qt::CustomContextMenu。<br>
注意：pos是该widget接收右键菜单事件的位置，一般是在该部件的坐标系中。但是对于QAbstratScrollArea及其子类例外，是对应着其视口viewport()的坐标系。如常用的QTableView、QHeaderView就是QAbstratScrollArea的子类。<br>
因为仅发信号，所以需自己写显示右键菜单的slot来响应，例如一个表格（QTableView类型）表头的显示右键菜单槽：<br>
datatable-&gt;horizontalHeader()-&gt;setContextMenuPolicy(Qt::CustomContextMenu);<br>
connect(datatable-&gt;horizontalHeader(), SIGNAL(customContextMenuRequested(const QPoint&amp;)),&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this, SLOT(show_contextmenu(const QPoint&amp;)));//this是datatable所在窗口<br>
QMenu *cmenu = NULL;<br>
show_contextmenu(const QPoint&amp; pos)<br>
{<br>
&nbsp;&nbsp;&nbsp; if(cmenu)//保证同时只存在一个menu，及时释放内存<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete cmenu;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmenu = NULL;<br>
&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; QMenu cmenu = new QMenu(datatable-&gt;horizontalHeader());<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp; QAction *ascendSortAction = cmenu-&gt;addAction("升序");<br>
&nbsp;&nbsp;&nbsp; QAction *descendSortAction = cmenu-&gt;addAction("降序");<br>
&nbsp;&nbsp;&nbsp; QAction *filterAction = cmenu-&gt;addAction("过滤");<br>
&nbsp;&nbsp;&nbsp; QAction *reshowAction = cmenu-&gt;addAction("重载");<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp; connect(ascendSortAction, SIGNAL(triggered(bool)), this, SLOT(sort_ascend()));<br>
&nbsp;&nbsp;&nbsp; connect(descendSortAction, SIGNAL(triggered(bool)), this, SLOT(sort_descend()));<br>
&nbsp;&nbsp;&nbsp; connect(filterAction, SIGNAL(triggered(bool)), this, SLOT(show_filter_dlg()));<br>
&nbsp;&nbsp;&nbsp; connect(reshowAction, SIGNAL(triggered(bool)), this, SLOT(reshow_data()));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp; cmenu-&gt;exec(QCursor::pos());//在当前鼠标位置显示<br>
&nbsp;&nbsp;&nbsp; //cmenu-&gt;exec(pos)是在viewport显示<br>
}</span></p>
<p><span>也可先做好cmenu，好处是始终使用一个：<br>
&nbsp;&nbsp;&nbsp; QMenu cmenu = new QMenu(datatable-&gt;horizontalHeader());<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp; QAction *ascendSortAction = cmenu-&gt;addAction("升序");<br>
&nbsp;&nbsp;&nbsp; QAction *descendSortAction = cmenu-&gt;addAction("降序");<br>
&nbsp;&nbsp;&nbsp; QAction *filterAction = cmenu-&gt;addAction("过滤");<br>
&nbsp;&nbsp;&nbsp; QAction *reshowAction = cmenu-&gt;addAction("重载");<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp; connect(ascendSortAction, SIGNAL(triggered(bool)), this, SLOT(sort_ascend()));<br>
&nbsp;&nbsp;&nbsp; connect(descendSortAction, SIGNAL(triggered(bool)), this, SLOT(sort_descend()));<br>
&nbsp;&nbsp;&nbsp; connect(filterAction, SIGNAL(triggered(bool)), this, SLOT(show_filter_dlg()));<br>
&nbsp;&nbsp;&nbsp; connect(reshowAction, SIGNAL(triggered(bool)), this, SLOT(reshow_data()));<br>
show_contextmenu(const QPoint&amp; pos)<br>
{<br>
&nbsp;&nbsp;&nbsp; if(cmenu)<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmenu-&gt;exec(QCursor::pos());<br>
&nbsp;&nbsp;&nbsp; }<br>
}</span></p>
<p><span><strong>3）使用Qt::ActionsContextMenu。<br>
</strong>把部件的所有action即QWidget::actions()作为context menu显示出来。<br>
还是上面的例子，要在表格（QTableView类型）表头显示右键菜单：<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QAction *ascendSortAction = new QAction("升序", this);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QAction *descendSortAction = new QAction("降序", this);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QAction *filterAction = new QAction("过滤", this);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QAction *unfilterAction = new QAction("取消过滤", this);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connect(ascendSortAction, SIGNAL(triggered(bool)), this, SLOT(sort_ascend()));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connect(descendSortAction, SIGNAL(triggered(bool)), this, SLOT(sort_descend()));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connect(filterAction, SIGNAL(triggered(bool)), this, SLOT(filter_table()));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connect(unfilterAction, SIGNAL(triggered(bool)), this, SLOT(unfilter_table()));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; datatable-&gt;horizontalHeader()-&gt;addAction(ascendSortAction);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; datatable-&gt;horizontalHeader()-&gt;addAction(descendSortAction);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; datatable-&gt;horizontalHeader()-&gt;addAction(filterAction);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; datatable-&gt;horizontalHeader()-&gt;addAction(unfilterAction);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; datatable-&gt;horizontalHeader()-&gt;setContextMenuPolicy(Qt::ActionsContextMenu);</span></p>
<p><span>另外两个就是不显示context menu了：<br>
Qt::NoContextMenu<br>
&nbsp;&nbsp;&nbsp; the widget does not feature a context menu, context menu handling is deferred to the widget's parent.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Qt::PreventContextMenu<br>
&nbsp;&nbsp;&nbsp; the widget does not feature a context menu, and in contrast to NoContextMenu, the handling is not deferred to the widget's parent. This means that all right mouse button events are guaranteed to be delivered to the widget itself through mousePressEvent(),
 and mouseReleaseEvent().</span></p>
<p><span><span><strong>补充：</strong><br>
&nbsp;&nbsp;&nbsp; 使用Qt::ActionsContextMenu比较简洁，但是如果需要根据当前菜单弹出的位置来定义不同菜单，或者像上个例子，在表格（QTableView类型）表头显示右键菜单时，我需要知道是哪一列表头被点击，从而在后来调用sort_ascend()排序函数时能够根据不同列进行不同排序策略，那么Qt::ActionsContextMenu就做不到了。<br>
&nbsp;&nbsp;&nbsp; 这种需要捕捉弹出位置的情况只好用Qt::ActionsContextMenu了，customContextMenuRequested ( const QPoint &amp; pos )信号返回点击位置pos（在表头视口坐标系中位置），然后表头即可调用logicalIndexAt(pos)函数得到被点击section对应的index即被点击部分的列号，然后存下来可供后面action激活的排序槽使用。<br>
show_contextmenu(const QPoint&amp; pos)<br>
{<br>
&nbsp;&nbsp;&nbsp; //get related column of headerview<br>
&nbsp;&nbsp;&nbsp; contextmenu_column = datatable-&gt;horizontalHeader()-&gt;logicalIndexAt(pos);</span></span></p>
<p><span>&nbsp;&nbsp;&nbsp; //show contextmenu<br>
&nbsp;&nbsp;&nbsp; if(cmenu)<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmenu-&gt;exec(QCursor::pos());<br>
&nbsp;&nbsp;&nbsp; }<br>
}</span></p>
<p><br>
</p>
<p>&nbsp;</p>
    
        <div>         
            <p>版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
        </div>
</div>




<!-- Baidu Button BEGIN -->




<div class="bdsharebuttonbox">
<a href="7724077.htm#" class="bds_more" data-cmd="more"></a>
<a href="7724077.htm#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
<a href="7724077.htm#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
<a href="7724077.htm#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a>
<a href="7724077.htm#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a>
<a href="7724077.htm#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
</div>

<!-- Baidu Button END -->

   <link rel="stylesheet" href="blog_detail.css">

    
<!--192.168.100.36-->
<ul class="article_next_prev">
            <li class="prev_article"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian']);location.href='/yuanzhangmei1/article/details/7719743';">上一篇</span><a href="http://blog.csdn.net/yuanzhangmei1/article/details/7719743" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian'])">布局管理总结</a></li>
            <li class="next_article"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian']);location.href='/yuanzhangmei1/article/details/7724831';">下一篇</span><a href="http://blog.csdn.net/yuanzhangmei1/article/details/7724831" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian'])">Qt中使用cout, cin, cerr</a></li>
</ul>

<!-- Baidu Button BEGIN -->



<!-- Baidu Button END -->

 

      
</div>
<div id="suggest"></div>
           




<dl class="blog-ass-articl" id="res-relatived"> 
     <dt><span>猜你在找</span></dt>    


   


    <div id="adCollege"> 
         
         
    <div class="tracking-ad" data-mod="popu_84"><dd style="background:url(blog-dot-red3.gif) no-repeat 0 10px; white-space: nowrap;"><a href="http://edu.csdn.net/course/detail/202" title="Windows CE车载应用的实现与相关技术点" strategy="content" target="_blank">Windows CE车载应用的实现与相关技术点</a></dd><dd style="background:url(blog-dot-red3.gif) no-repeat 0 10px; white-space: nowrap;"><a href="http://edu.csdn.net/course/detail/512" title="iOS8-Swift开发教程" strategy="content" target="_blank">iOS8-Swift开发教程</a></dd><dd style="background:url(blog-dot-red3.gif) no-repeat 0 10px; white-space: nowrap;"><a href="http://edu.csdn.net/course/detail/162" title="Qt基础与Qt on Android入门" strategy="content" target="_blank">Qt基础与Qt on Android入门</a></dd><dd style="background:url(blog-dot-red3.gif) no-repeat 0 10px; white-space: nowrap;"><a href="http://edu.csdn.net/course/detail/532" title="iOS即时通讯(IM)开发实战篇-基于XMPP的聊天软件开发" strategy="content" target="_blank">iOS即时通讯(IM)开发实战篇-基于XMPP的聊天软件开发</a></dd><dd style="background:url(blog-dot-red3.gif) no-repeat 0 10px; white-space: nowrap;"><a href="http://edu.csdn.net/course/detail/1158" title="Python编程基础视频教程(第二季)" strategy="hot" target="_blank">Python编程基础视频教程(第二季)</a></dd></div></div>  

    
     <div id="res" data-mod="popu_36" class="tracking-ad"></div>
   
</dl>

<div id="job_blog_reco"><dl class="blog-ass-articl tracking-ad" data-mod="popu_72"><dt><span>准备好了么？&nbsp;<label class="po_blg_detail_tiao">跳</label><label class="po_blg_detail_ba">吧</label><label class="po_blg_detail_th">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;！</label></span><a href="http://job.csdn.net/" target="_blank" class="po_blg_more">更多职位尽在&nbsp;<label class="po_blg_detail_csdn">CSDN JOB</label></a></dt><dd class="po_blg_dd"><div class="po_blg_po"><a href="http://job.csdn.net/Job/Index?jobID=129925" title="PHP后端开发工程师，跳过来吧" strategy="PersonalRecommend" target="_blank">PHP后端开发工程师，跳过来吧</a></div><div class="po_blg_company"><a href="http://pr.csdn.net/enterprise/ent_home?orgid=435667" title="成都九州雅讯科技有限责任公司" target="_blank">成都九州雅讯科技有限责任公司</a></div><label class="po_blg_separator">|</label><div class="po_blg_salary"><a href="http://job.csdn.net/Job/Index?jobID=129925" target="_blank">8-13K/月</a></div><a class="po_blg_iwant" href="http://job.csdn.net/Job/Index?jobID=129925" target="_blank">我要跳槽</a></dd><dd class="po_blg_dd"><div class="po_blg_po"><a href="http://job.csdn.net/Job/Index?jobID=141773" title="iOS开发工程师" strategy="PersonalRecommend" target="_blank">iOS开发工程师</a></div><div class="po_blg_company"><a href="http://pr.csdn.net/enterprise/ent_home?orgid=212552" title="成都迈思信息技术有限公司" target="_blank">成都迈思信息技术有限公司</a></div><label class="po_blg_separator">|</label><div class="po_blg_salary"><a href="http://job.csdn.net/Job/Index?jobID=141773" target="_blank">6-12K/月</a></div><a class="po_blg_iwant" href="http://job.csdn.net/Job/Index?jobID=141773" target="_blank">我要跳槽</a></dd><dd class="po_blg_dd"><div class="po_blg_po"><a href="http://job.csdn.net/Job/Index?jobID=141091" title="Unity3D程序开发工程师" strategy="PersonalRecommend" target="_blank">Unity3D程序开发工程师</a></div><div class="po_blg_company"><a href="http://pr.csdn.net/enterprise/ent_home?orgid=374732" title="成都墨龙科技有限公司" target="_blank">成都墨龙科技有限公司</a></div><label class="po_blg_separator">|</label><div class="po_blg_salary"><a href="http://job.csdn.net/Job/Index?jobID=141091" target="_blank">5-10K/月</a></div><a class="po_blg_iwant" href="http://job.csdn.net/Job/Index?jobID=141091" target="_blank">我要跳槽</a></dd><dd class="po_blg_dd"><div class="po_blg_po"><a href="http://job.csdn.net/Job/Index?jobID=142703" title="区域主管" strategy="PersonalRecommend" target="_blank">区域主管</a></div><div class="po_blg_company"><a href="http://pr.csdn.net/enterprise/ent_home?orgid=435100" title="上海欢校信息科技有限公司" target="_blank">上海欢校信息科技有限公司</a></div><label class="po_blg_separator">|</label><div class="po_blg_salary"><a href="http://job.csdn.net/Job/Index?jobID=142703" target="_blank">5-10K/月</a></div><a class="po_blg_iwant" href="http://job.csdn.net/Job/Index?jobID=142703" target="_blank">我要跳槽</a></dd></dl></div>

   

    <div id="ad_cen">
   
          
    </div>
<div class="comment_class">
    <div id="comment_title" class="panel_head">
        <span class="see_comment">查看评论</span><a name="comments"></a></div>
    <div id="comment_list">
    </div>
    <div id="comment_bar">
    </div>
    <div id="comment_form">
    </div>

    <div class="announce">
        * 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
</div>



    <div id="ad_bot">
    </div>
    
<div id="report_dialog">
</div>

<div id="d-top">
        <a id="quick-reply" class="btn btn-top q-reply" title="快速回复">
            <img src="blog-icon-reply.png" alt="快速回复">
        </a>    

    <a id="d-top-a" class="btn btn-top backtop" title="返回顶部" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_huidaodingbu'])">         
         <img src="top.png" alt="TOP">
    </a>
</div>




<div class="tag_list"></div>
   


<div id="pop_win">
    
</div>
<div id="popup_mask"></div>






                        <div class="clear">
                        </div>
                    </div>                   
                
            </div>
                   
           <div id="side">
    <div class="side">
                        <div id="Profile"></div>
                            
                        <div id="Search"></div>
                            
                        <div id="SpecialColumn"></div>
                            
                        <div id="Category"></div>
                            
                        <div id="Archive"></div>
                            
                        <div id="ViewCountArticles"></div>
                            
                        <div id="CommentCountArticles"></div>
                            
                        <div id="HomePageArticles"></div>
                            
                        <div id="NewComments"></div>
                            
    </div>
    <div class="clear">
    </div>
 </div>   
            <div class="clear">
            </div>
        </div>
        






<link rel="stylesheet" type="text/css" href="pub_footer_2014.css"><div class="pub_fo"><div id="pub_footerall" class="pub_footer_new"><dl><dt></dt> <dd class="foot_sub_menu"><a href="http://www.csdn.net/company/about.html" target="_blank">公司简介</a><span>|</span><a href="http://www.csdn.net/company/recruit.html" target="_blank">招贤纳士</a><span>|</span><a href="http://www.csdn.net/company/marketing.html" target="_blank">广告服务</a><span>|</span><a href="http://www.csdn.net/company/account.html" target="_blank">银行汇款帐号</a><span>|</span><a href="http://www.csdn.net/company/contact.html" target="_blank">联系方式</a><span>|</span><a href="http://www.csdn.net/company/statement.html" target="_blank">版权声明</a><span>|</span><a href="http://www.csdn.net/company/layer.html" target="_blank">法律顾问</a><span>|</span><a href="mailto:webmaster@csdn.net">问题报告</a><span>|</span><a target="_blank" href="http://www.csdn.net/friendlink.html">合作伙伴</a><span>|</span><a href="http://bbs.csdn.net/forums/Service" target="_blank">论坛反馈</a></dd><dd class="foot_contact"><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2355263776&amp;site=qq&amp;menu=yes" target="_blank" class="qq">网站客服</a><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2251809102&amp;site=qq&amp;menu=yes" target="_blank" class="qq">杂志客服</a><a href="http://e.weibo.com/csdnsupport/profile" target="_blank" class="weibo">微博客服</a><a href="mailto:webmaster@csdn.net" class="email" title="联系邮箱">webmaster@csdn.net</a><span class="phone" title="服务热线">400-600-2320</span><span class="interval">|</span><span>北京创新乐知信息技术有限公司 版权所有</span><span class="interval">|</span><span>江苏乐知网络技术有限公司 提供商务支持</span></dd><dd class="foot_copyright"><span>京&nbsp;ICP&nbsp;证&nbsp;070598&nbsp;号</span><span class="interval">|</span><span>Copyright © 1999-2014, CSDN.NET, All Rights Reserved&nbsp;</span><a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" target="_blank"><img src="gongshang_logos.gif" alt="GongshangLogo" title=""></a></dd></dl></div></div><div id="note1" class="csdn_note" style="display:none; position:absolute; z-index:9999; width:440px">  <span class="notice_top_arrow"><span class="inner"></span></span>  <div class="box"></div></div><div class="csdn_notice_tip" style="position: absolute; z-index: 9990; width: 170px; display: none; ">  <iframe src="about:blank" frameborder="0" scrolling="no" style="z-index:-1;position:absolute;top:0;left:0;width:100%;height:100%;background:transparent" src="1.htm"></iframe>  <div class="tip_text">您有<strong>0</strong>条新通知</div>  <a href="javascript:void 0" class="close2"></a></div>

<img src="http://counter.csdn.net/pv.aspx?id=24" border="0" width="0" height="0">








    </div><input type="hidden" id="aa_g_data_ids">
      <!--new top-->
    
    
     <!--new top-->
   
    <link href="ask_float_block.css" type="text/css" rel="stylesheet">
    
    
    
    </body></html>
