<html><!--STATUS OK--><head><meta charset="UTF-8">

<meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport"><meta name="baidu-tc" content="siteapp"><title>常用SQL查询语句 - sunada - 博客园</title><link type="text/css" rel="stylesheet" href="ss-0.6.35.css"></head><body data-dict="30" data-srd="1" class="PAGE_TYPE_NEWS_CONTENT WIDE_STRUCT Blocks_cont_4 Sitetype_6 Struct_page_type_1 hAndroid" data-page_type="PAGE_TYPE_NEWS_CONTENT"><header class="ssPageHeader"><nav class="pageNav"><i onclick="history.back()" class="icon top-back" data-tj="backBtn"></i><span class="slogan">博客园</span><i class="icon search tap" data-showel="#searchFormBox" data-tj="searchFormBox" data-action="saNavTabSelector"></i></nav><div id="searchFormBox" class="navCard noDis"><div class="hCard saNavSearchBox"><form class="saBDSearch" action="http://m.baidu.com/s" method="get"><input placeholder="请输入内容" type="text" name="word" value=""><input type="submit" value="百度一下"><input type="hidden" name="from" value="1001983a"></form></div></div></header><div class="w-normal yi-normal-title" ssweight="1">常用SQL查询语句 </div><div class=" yi-content-text" ssweight="1"><div><span>一、简单查询语句</span></div><div><span>1. 查看表结构</span></div><div><span>SQL&gt;DESC emp;</span></div><div><span>2. 查询所有列</span></div><div><span>SQL&gt;SELECT * FROM emp;</span></div><div><span>3. 查询指定列</span></div><div><span>SQL&gt;SELECT empmo, ename, mgr FROM emp;</span></div><div><span>SQL&gt;SELECT DISTINCT mgr FROM emp; 只显示结果不同的项</span></div><div><span>4. 查询指定行</span></div><div><span>SQL&gt;SELECT * FROM emp WHERE job='CLERK';</span></div><div><span>5. 使用算术表达式</span></div><div><span>SQL&gt;SELECT ename, sal*13+nvl(comm,0)  FROM emp; </span></div><div><span>nvl(comm,1)的意思是，如果comm中有值，则nvl(comm,1)=comm; comm中无值，则nvl(comm,1)=0。</span></div><div><span>SQL&gt;SELECT ename, sal*13+nvl(comm,0) year_sal FROM emp; （year_sal为别名，可按别名排序）</span></div><div><span>SQL&gt;SELECT * FROM emp WHERE hiredate&gt;'01-1月-82';</span></div><div><span>6. 使用like操作符（%，_）</span></div><div><span>%表示一个或多个字符，_表示一个字符，[charlist]表示字符列中的任何单一字符，[^charlist]或者[!charlist]不在字符列中的任何单一字符。</span></div><div><span>SQL&gt;SELECT * FROM emp WHERE ename like 'S__T%';</span></div><div><span>7. 在where条件中使用In</span></div><div><span>SQL&gt;SELECT * FROM emp WHERE job IN ('CLERK','ANALYST');</span></div><div><span>8. 查询字段内容为空/非空的语句</span></div><div><span>SQL&gt;SELECT * FROM emp WHERE mgr IS/IS NOT NULL; </span></div><div><span>9. 使用逻辑操作符号</span></div><div><span>SQL&gt;SELECT * FROM emp WHERE (sal&gt;500 or job='MANAGE') and ename like 'J%';</span></div><div><span>10. 将查询结果按字段的值进行排序</span></div><div><span>SQL&gt;SELECT * FROM emp ORDER BY deptno, sal DESC; (按部门升序，并按薪酬降序)</span></div><div><span>二、复杂查询</span></div><div><span>1. 数据分组(max,min,avg,sum,count)</span></div><div><span>SQL&gt;SELECT MAX(sal),MIN(age),AVG(sal),SUM(sal) from emp;</span></div><div><span>SQL&gt;SELECT * FROM emp where sal=(SELECT MAX(sal) from emp));</span></div><div><span>SQL&gt;SELEC COUNT(*) FROM emp;</span></div><div><span>2. group by（用于对查询结果的分组统计） 和 having子句（用于限制分组显示结果）</span></div><div><span>SQL&gt;SELECT deptno,MAX(sal),AVG(sal) FROM emp GROUP BY deptno;</span></div><div><span>SQL&gt;SELECT deptno, job, AVG(sal),MIN(sal) FROM emp group by deptno,job having AVG(sal)&lt;2000;</span></div><div><span>对于数据分组的总结：</span></div><div><span>a. 分组函数只能出现在选择列表、having、order by子句中（不能出现在where中）</span></div><div><span>b. 如果select语句中同时包含有group by, having, order by，那么它们的顺序是group by, having, order by。</span></div><div><span>c. 在选择列中如果有列、表达式和分组函数，那么这些列和表达式必须出现在group by子句中，否则就是会出错。</span></div><div><span>使用group by不是使用having的前提条件。</span></div><div><span>3. 多表查询</span></div><div><span>SQL&gt;SELECT e.name,e.sal,d.dname FROM emp e, dept d WHERE e.deptno=d.deptno order by d.deptno;</span></div><div><span>SQL&gt;SELECT e.ename,e.sal,s.grade FROM emp e,salgrade s WHER e.sal BETWEEN s.losal AND s.hisal;</span></div><div><span>4. 自连接（指同一张表的连接查询）</span></div><div><span>SQL&gt;SELECT er.ename, ee.ename mgr_name from emp er, emp ee where er.mgr=ee.empno;</span></div><div><span>5. 子查询（嵌入到其他sql语句中的select语句，也叫嵌套查询）</span></div><div><span>5.1 单行子查询</span></div><div><span>SQL&gt;SELECT ename FROM emp WHERE deptno=(SELECT deptno FROM emp where ename='SMITH');查询表中与smith同部门的人员名字。因为返回结果只有一行，所以用“=”连接子查询语句</span></div><div><span>5.2 多行子查询</span></div><div><span>SQL&gt;SELECT ename,job,sal,deptno from emp WHERE job IN (SELECT DISTINCT job FROM emp WHERE deptno=10);查询表中与部门号为10的工作相同的员工的姓名、工作、薪水、部门号。因为返回结果有多行，所以用“IN”连接子查询语句。</span></div><div><span>in与exists的区别： </span><span>exists() 后面的子查询被称做相关子查询，它是不返回列表的值的。只是返回一个ture或false的结果，其运行方式是先运行主查询一次，再去子查询里查询与其对 应的结果。如果是ture则输出，反之则不输出。再根据主查询中的每一行去子查询里去查询。in()后面的子查询，是返回结果集的，换句话说执行次序和 exists()不一样。子查询先产生结果集，然后主查询再去结果集里去找符合要求的字段列表去。符合要求的输出，反之则不输出。</span></div><div><span>5.3 使用ALL</span></div><div><span>SQL&gt;SELECT ename,sal,deptno FROM emp WHERE sal&gt; ALL (SELECT sal FROM emp WHERE deptno=30);或SQL&gt;SELECT ename,sal,deptno FROM emp WHERE sal&gt; (SELECT MAX(sal) FROM emp WHERE deptno=30);查询工资比部门号为30号的所有员工工资都高的员工的姓名、薪水和部门号。以上两个语句在功能上是一样的，但执行效率上，函数会高 得多。</span></div><div><span>5.4 使用ANY</span></div><div><span>SQL&gt;SELECT ename,sal,deptno FROM emp WHERE sal&gt; ANY (SELECT sal FROM emp WHERE deptno=30);或SQL&gt;SELECT ename,sal,deptno FROM emp WHERE sal&gt; (SELECT MIN(sal) FROM emp WHERE deptno=30);查询工资比部门号为30号的任意一个员工工资高（只要比某一员工工资高即可）的员工的姓名、薪水和部门号。以上两个语句在功能上是 一样的，但执行效率上，函数会高得多。</span></div><div><span>5.5 多列子查询</span></div><div><span>SQL&gt;SELECT * FROM emp WHERE (job, deptno)=(SELECT job, deptno FROM emp WHERE ename='SMITH');</span></div><div><span>5.6 在from子句中使用子查询</span></div><div><span>SQL&gt;SELECT emp.deptno,emp.ename,emp.sal,t_avgsal.avgsal FROM emp,(SELECT emp.deptno,avg(emp.sal) avgsal FROM emp GROUP BY emp.deptno) t_avgsal where emp.deptno=t_avgsal.deptno AND emp.sal&gt;t_avgsal.avgsal ORDER BY emp.deptno;</span></div><div><span>5.7 分页查询</span></div><div><span>数据库的每行数据都有一个对应的行号，称为rownum.</span></div><div><span>SQL&gt;SELECT a2.* FROM (SELECT a1.*, ROWNUM rn FROM (SELECT * FROM emp ORDER BY sal) a1 WHERE ROWNUM&lt;=10) a2 WHERE rn&gt;=6;</span></div><div><span>指定查询列、查询结果排序等，都只需要修改最里层的子查询即可。</span></div><div><span>5.8 用查询结果创建新表</span></div><div><span>SQL&gt;CREATE TABLE mytable (id,name,sal,job,deptno) AS SELECT empno,ename,sal,job,deptno FROM emp;</span></div><div><span>5.9 合并查询（union 并集, intersect 交集, union all 并集+交集, minus差集)</span></div><div><span>SQL&gt;SELECT ename, sal, job FROM emp WHERE sal&gt;2500 UNION(INTERSECT/UNION ALL/MINUS) SELECT ename, sal, job FROM emp WHERE job='MANAGER';</span></div><div><span>合并查询的执行效率远高于and,or等逻辑查询。</span></div><div><span>5.10 使用子查询插入数据</span></div><div><span>SQL&gt;CREATE TABLE myEmp(empID number(4), name varchar2(20), sal number(6), job varchar2(10), dept number(2)); 先建一张空表；</span></div><div><span>SQL&gt;INSERT INTO myEmp(empID, name, sal, job, dept) SELECT empno, ename, sal, job, deptno FROM emp WHERE deptno=10; 再将emp表中部门号为10的数据插入到新表myEmp中，实现数据的批量查询。</span></div><div><span>5.11 使用了查询更新表中的数据</span></div><div><span>SQL&gt;UPDATE emp SET(job, sal, comm)=(SELECT job, sal, comm FROM emp where ename='SMITH') WHERE ename='SCOTT';</span></div></div><div class="yi-prenext" ssweight="1"><div class="yi-prenext-title">延伸阅读：</div><a data-addparam="nextpage=1" href="http://m.baidu.com/from=2001a/bd_page_type=1/ssid=0/uid=0/pu=usm%400%2Csz%401320_1003%2Cta%40iphone_2_4.4_1_10.6/baiduid=9A9325E51157B9C6B9B4ACC4923960DA/w=0_10_SQL+%E6%9F%A5%E8%AF%A2/t=iphone/l=3/tc?m=8&amp;srd=1&amp;dict=30&amp;title=%25u5E38%25u7528SQL%25u67E5%25u8BE2%25u8BED%25u53E5-sunada-%25u535A%25u5BA2%25u56ED&amp;nextpage=1&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3411430.html" class="yi-pre"><span class="yi-prenext-a">上一篇</span><span class="yi-fontcolor">【转】python中常用第三方包os sys</span></a><a data-addparam="nextpage=1" href="http://m.baidu.com/from=2001a/bd_page_type=1/ssid=0/uid=0/pu=usm%400%2Csz%401320_1003%2Cta%40iphone_2_4.4_1_10.6/baiduid=9A9325E51157B9C6B9B4ACC4923960DA/w=0_10_SQL+%E6%9F%A5%E8%AF%A2/t=iphone/l=3/tc?m=8&amp;srd=1&amp;dict=30&amp;title=%25u5E38%25u7528SQL%25u67E5%25u8BE2%25u8BED%25u53E5-sunada-%25u535A%25u5BA2%25u56ED&amp;nextpage=1&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3411991.html" class="yi-next"><span class="yi-prenext-a">下一篇</span><span class="yi-fontcolor">【转】SQL语句中的正则表达示</span></a></div><div class="newsRecommend" ssweight="1"><div class="newsRecommendTitle">更多内容</div><ul class="newsRecommendUl"><li class="newsRecommendLi"><a href="http://m.baidu.com/from=2001a/bd_page_type=1/ssid=0/uid=0/pu=usm%400%2Csz%401320_1003%2Cta%40iphone_2_4.4_1_10.6/baiduid=9A9325E51157B9C6B9B4ACC4923960DA/w=0_10_SQL+%E6%9F%A5%E8%AF%A2/t=iphone/l=3/tc?m=8&amp;srd=1&amp;dict=30&amp;title=%25u5E38%25u7528SQL%25u67E5%25u8BE2%25u8BED%25u53E5-sunada-%25u535A%25u5BA2%25u56ED&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3304593.html">1. 【转】HTTP长连接与短连接(2)</a></li><li class="newsRecommendLi"><a href="http://m.baidu.com/from=2001a/bd_page_type=1/ssid=0/uid=0/pu=usm%400%2Csz%401320_1003%2Cta%40iphone_2_4.4_1_10.6/baiduid=9A9325E51157B9C6B9B4ACC4923960DA/w=0_10_SQL+%E6%9F%A5%E8%AF%A2/t=iphone/l=3/tc?m=8&amp;srd=1&amp;dict=30&amp;title=%25u5E38%25u7528SQL%25u67E5%25u8BE2%25u8BED%25u53E5-sunada-%25u535A%25u5BA2%25u56ED&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3183759.html">2. 【转】python代码风格-PEP8(1)</a></li><li class="newsRecommendLi"><a href="http://m.baidu.com/from=2001a/bd_page_type=1/ssid=0/uid=0/pu=usm%400%2Csz%401320_1003%2Cta%40iphone_2_4.4_1_10.6/baiduid=9A9325E51157B9C6B9B4ACC4923960DA/w=0_10_SQL+%E6%9F%A5%E8%AF%A2/t=iphone/l=3/tc?m=8&amp;srd=1&amp;dict=30&amp;title=%25u5E38%25u7528SQL%25u67E5%25u8BE2%25u8BED%25u53E5-sunada-%25u535A%25u5BA2%25u56ED&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3536891.html">3. hibernate入门实例(1)</a></li><li class="newsRecommendLi"><a href="http://m.baidu.com/from=2001a/bd_page_type=1/ssid=0/uid=0/pu=usm%400%2Csz%401320_1003%2Cta%40iphone_2_4.4_1_10.6/baiduid=9A9325E51157B9C6B9B4ACC4923960DA/w=0_10_SQL+%E6%9F%A5%E8%AF%A2/t=iphone/l=3/tc?m=8&amp;srd=1&amp;dict=30&amp;title=%25u5E38%25u7528SQL%25u67E5%25u8BE2%25u8BED%25u53E5-sunada-%25u535A%25u5BA2%25u56ED&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3357201.html">4. win7上搭建ruby开发环境(1)</a></li><li class="newsRecommendLi"><a href="http://m.baidu.com/from=2001a/bd_page_type=1/ssid=0/uid=0/pu=usm%400%2Csz%401320_1003%2Cta%40iphone_2_4.4_1_10.6/baiduid=9A9325E51157B9C6B9B4ACC4923960DA/w=0_10_SQL+%E6%9F%A5%E8%AF%A2/t=iphone/l=3/tc?m=8&amp;srd=1&amp;dict=30&amp;title=%25u5E38%25u7528SQL%25u67E5%25u8BE2%25u8BED%25u53E5-sunada-%25u535A%25u5BA2%25u56ED&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3334821.html">5. 【转】与BT下载相关的概念(1)</a></li></ul></div><div id="web-recommend-new" style="" class="web-recommend-new pannel" data-page-src="http://www.cnblogs.com/sunada2005/p/3411873.html"><div class="newsRecommendTitle">大家也在搜</div><ul><li style="padding-top:0" class="item-show"><a class="word hot" data-action="down" href="http://m.baidu.com/s?word=sql%E6%9F%A5%E8%AF%A2%E8%A1%A8%E7%9A%84%E8%AF%AD%E5%8F%A5%E6%98%AF%E4%BB%80%E4%B9%88&amp;from=1001560s&amp;pu=ofrom%401001560l&amp;sa=npr_2_1"><span class="word-content">sql查询表的语句是什么</span></a></li><li style="padding-top:0" class="item-show"><a class="word" data-action="down" href="http://m.baidu.com/s?word=%E8%85%B0%E6%A4%8E%E9%97%B4%E7%9B%98%E7%AA%81%E5%87%BA%E7%9A%84%E6%B2%BB%E7%96%97%E6%96%B9%E6%B3%95&amp;from=1001560t&amp;pu=ofrom%401001560l&amp;sa=npr_2_2"><span class="word-content">腰椎间盘突出的治疗方法</span></a></li><li class="item-show"><a class="word" data-action="down" href="http://m.baidu.com/s?word=%E7%96%A4%E7%97%95%E5%A2%9E%E7%94%9F&amp;from=1001560u&amp;pu=ofrom%401001560l&amp;sa=npr_2_3"><span class="word-content">疤痕增生</span></a></li><li class="item-show"><a class="word hot" data-action="down" href="http://m.baidu.com/s?word=%E7%94%B7%E4%BA%BA%E7%9A%84%E7%B2%BE%E5%AD%90%E8%83%BD%E5%90%83&amp;from=1001560v&amp;pu=ofrom%401001560l&amp;sa=npr_2_4"><span class="word-content">男人的精子能吃</span></a></li><li class="item-show"><a class="word" data-action="down" href="http://m.baidu.com/s?word=%E4%B8%93%E6%B2%BB%E9%AA%A8%E8%B4%A8%E5%A2%9E%E7%94%9F&amp;from=1001560w&amp;pu=ofrom%401001560l&amp;sa=npr_2_5"><span class="word-content">专治骨质增生</span></a></li><li class="item-show"><a class="word" data-action="down" href="http://m.baidu.com/s?word=%E7%B2%BE%E5%AD%90%E6%9E%9C%E5%86%BB%E7%8A%B6&amp;from=1001560x&amp;pu=ofrom%401001560l&amp;sa=npr_2_6"><span class="word-content">精子果冻状</span></a></li><li class="item-show"><a class="word" data-action="down" href="http://m.baidu.com/s?word=%E7%97%94%E7%96%AE%E7%9A%84%E6%B2%BB%E7%96%97%E6%96%B9%E6%B3%95&amp;from=1001560y&amp;pu=ofrom%401001560l&amp;sa=npr_2_7"><span class="word-content">痔疮的治疗方法</span></a></li><li class="item-show"><a class="word" data-action="down" href="http://m.baidu.com/s?word=%E6%80%8E%E6%A0%B7%E5%8E%BB%E9%99%A4%E7%9C%BC%E8%A2%8B&amp;from=1001560z&amp;pu=ofrom%401001560l&amp;sa=npr_2_8"><span class="word-content">怎样去除眼袋</span></a></li></ul><div style="clear:both;"></div><form class="" action="http://m.baidu.com/s" method="get"><input placeholder="请输入内容" type="text" name="word" value=""><button type="submit" data-tj="contentSearch">百度一下</button><input type="hidden" name="sa" value="ops_1"><input type="hidden" id="ssOfrom" name="ofrom" value=""></form></div><div class="appBanner"><img src="appBanner.png"></div><div class="saFooter"><div class="saFooterOld"><a class="toolbar-pcPageUrl-light yi-www" href="http://m.siteapp.baidu.com/redirect/?from=tcwise&amp;type=pcURLBottom&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3411873.html&amp;mask=3116ac10c04e80ff78859eac6dabd62c"><span>电脑版</span></a><a class="toolbar-goBack-light yi-www" href="tc_ref_www_iphone_lid_12739131173517409671_order_5_vit_osres.htm#"><span>回顶部</span></a></div><div class="saFooterNew"><a target="_blank" class="yi-www" href="http://m.baidu.com/pub/help.php?pn=22&amp;ssid=0&amp;from=844b&amp;bd_page_type=1&amp;uid=&amp;pu=usm%405%2Csz%401330_220%2Cta%40big_3_7.5_4_9.0">转码声明</a><a target="_blank" class="yi-www" href="http://feedback.baidu.com/">用户反馈</a><a target="_blank" class="yi-www" href="http://m.siteapp.baidu.com/redirect/?from=tcwise&amp;type=pcWebSiteCallBack&amp;src=http%3A%2F%2Fm.siteapp.baidu.com%2Frenling%2Frenling.php%3Ffrom%3Dbaidusearch%26domain%3Dcnblogs.com&amp;mask=5db8e56a2d6f457a0d0758c0d9cd3a6d">站长认领</a></div></div><div id="tool-box"><div id="tool-bg"><div id="tool-bar"><a class="toolbar-search yi-www" data-action="down" href="http://m.baidu.com/?from=1001983a"><i class="icon"></i>百度</a><a class="toolbar-goBack yi-www tap" data-action="down" data-js="saHideToolBarBox();"><i class="icon"></i>回顶部</a><a id="toolbar-share" data-action="down" class="toolbar-share"><i class="icon"></i>分享</a><a class="toolbar-pcPageUrl yi-www" data-action="down" href="http://siteapp.baidu.com/app/redirect/?from=tcwise&amp;type=pcURLToolBox&amp;src=http%3A%2F%2Fwww.cnblogs.com%2Fsunada2005%2Fp%2F3411873.html"><i class="icon"></i>电脑版</a></div></div><div id="tool-bt"><span data-action="down"></span></div></div><iframe src="mp-cdn.html" style="display: none; "></iframe></body></html>
